# GitHub Actions를 통한 주식 데이터 크롤링 설정

## 🚀 개요

이 가이드는 GitHub Actions를 사용하여 매일 자동으로 주식 데이터를 크롤링하고 저장소에 업데이트하는 방법을 설명합니다.

## ✅ 장점

- **로컬 환경 불필요**: 컴퓨터를 켜둘 필요 없음
- **자동 실행**: 매일 새벽 1시 자동 실행
- **무료**: GitHub Actions의 무료 할당량 사용
- **자동 커밋**: 데이터가 자동으로 저장소에 반영
- **모니터링**: 실행 상태를 GitHub에서 실시간 확인

## 🛠️ 설정 방법

### 1. **GitHub 저장소에 파일 업로드**

다음 파일들이 저장소에 있어야 합니다:
```
.github/workflows/stock-crawler.yml  # GitHub Actions 워크플로우
crawler/stock_crawler.py            # 메인 크롤러
crawler/requirements.txt             # Python 의존성
crawler/test_github_actions.py      # 테스트 스크립트
```

### 2. **Actions 탭에서 워크플로우 확인**

1. GitHub 저장소에서 **Actions** 탭 클릭
2. **Stock Data Crawler** 워크플로우가 표시되는지 확인
3. 워크플로우가 비활성화되어 있다면 **Enable workflow** 클릭

### 3. **수동 실행 테스트**

1. Actions 탭에서 **Stock Data Crawler** 선택
2. **Run workflow** 버튼 클릭
3. **Run workflow** 클릭하여 실행
4. 실행 과정과 결과 확인

## 📅 실행 스케줄

### 자동 실행
- **시간**: 매일 새벽 1시 (UTC 기준)
- **한국 시간**: 매일 새벽 10시
- **트리거**: cron 스케줄러

### 수동 실행
- 언제든지 Actions 탭에서 수동 실행 가능
- 코드 변경 시 자동으로 실행됨

## 📊 실행 결과 확인

### 1. **Actions 탭에서 확인**
- 실행 상태 (✅ 성공, ❌ 실패)
- 실행 시간 및 소요 시간
- 로그 및 오류 메시지

### 2. **생성된 데이터 확인**
- `data/latest_stock_data.json`: 최신 데이터
- `data/stock_data_YYYYMMDD.json`: 일일 데이터
- 실행 후 자동으로 저장소에 커밋됨

### 3. **데이터 요약 확인**
- 각 실행 후 자동으로 생성되는 요약 정보
- 수집된 종목 수, 뉴스 건수, 실행 시간 등

## 🔧 워크플로우 커스터마이징

### 실행 시간 변경
```yaml
on:
  schedule:
    - cron: '0 1 * * *'  # 매일 새벽 1시 (UTC)
    # 다른 시간으로 변경하려면 cron 표현식 수정
```

### 실행 조건 추가
```yaml
on:
  schedule:
    - cron: '0 1 * * *'
  workflow_dispatch:     # 수동 실행
  push:                  # 코드 변경 시 실행
    branches: [ main ]
    paths:
      - 'crawler/**'
```

### 환경 변수 설정
```yaml
env:
  DATA_DIR: data
  PYTHON_VERSION: '3.9'
```

## 🚨 문제 해결

### 1. **워크플로우가 실행되지 않는 경우**
- **Actions 탭 확인**: 워크플로우가 활성화되어 있는지 확인
- **권한 확인**: 저장소에 Actions 권한이 있는지 확인
- **스케줄 확인**: cron 표현식이 올바른지 확인

### 2. **크롤링 실패 시**
- **로그 확인**: Actions 탭에서 실행 로그 확인
- **의존성 확인**: requirements.txt 파일이 올바른지 확인
- **네트워크 확인**: 외부 사이트 접근이 가능한지 확인

### 3. **데이터 파일이 생성되지 않는 경우**
- **Python 오류**: 크롤러 실행 중 Python 오류 확인
- **권한 문제**: 파일 쓰기 권한 확인
- **경로 문제**: 데이터 디렉토리 경로 확인

## 📈 모니터링 및 알림

### 1. **실행 상태 모니터링**
- GitHub Actions 탭에서 실시간 모니터링
- 실행 성공/실패 알림
- 실행 시간 및 소요 시간 추적

### 2. **데이터 품질 확인**
- 수집된 종목 수 확인
- 뉴스 건수 확인
- 데이터 타임스탬프 확인

### 3. **오류 알림**
- 크롤링 실패 시 로그에서 오류 확인
- 네트워크 오류, 파싱 오류 등 구분

## 🔒 보안 고려사항

### 1. **저장소 권한**
- Actions 워크플로우는 저장소에 직접 접근
- 민감한 정보는 환경 변수로 관리
- 필요한 최소 권한만 부여

### 2. **데이터 검증**
- 크롤링된 데이터의 유효성 검증
- 오류 데이터 필터링
- 데이터 백업 및 복구

## 📞 지원 및 문의

### 문제 발생 시
1. **Actions 로그 확인**: 실행 과정에서 발생한 오류 확인
2. **데이터 파일 확인**: 생성된 JSON 파일 내용 확인
3. **의존성 확인**: Python 패키지 설치 상태 확인
4. **네트워크 확인**: 외부 사이트 접근 가능 여부 확인

### 추가 기능 요청
- 새로운 데이터 소스 추가
- 크롤링 주기 조정
- 데이터 형식 변경
- 알림 기능 추가

---

**마지막 업데이트**: 2024년 1월 15일  
**버전**: 2.0.0 (GitHub Actions 기반)  
**작성자**: 투자 분석 시스템 개발팀
